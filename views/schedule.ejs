<%- include('partials/header') -%>
<main>
    <div class="column-container">
        <div class="box create-container">
            <section class="create-project">
                <div class="row justify-content-center">
                    <div class="col-6 mt-5">
                        <h2>Create a New Project</h2>
                        <form action="/schedule/createProject" method="POST">
                            <div class="mb-3">
                                <label for="title" class="form-label">Title</label>
                                <input type="text" class="form-control" id="title" name="title">
                            </div>
                            <div class="mb-3">
                                <label for="description" class="form-label">Description</label>
                                <textarea class="form-control" id="description" name="description"></textarea>
                            </div>
                            <button type="submit" class="btn bg-info" style="color:white" value="Upload">Submit</button>
                        </form>
                    </div>
                </div>
            </section>
        
            <section class="create-task">
                <div class="row justify-content-center">
                    <div class="col-6 mt-5">
                        <h2>Create a New Task</h2>
                        <form action="/schedule/createTask" method="POST">
                            <div class="mb-3">
                                <label for="projectId" class="form-label">Project</label>
                                <select class="form-control" id="projectId" name="projectId">
                                    <option label=" "></option>
                                    <% for(let i = 0; i < projects.length; i++){ %>
                                        <option value="<%= projects[i]._id %>"><%= projects[i].title %></option>
                                    <% } %>
                                </select>
                            </div>
                            <div class="mb-3">
                                <label for="title" class="form-label">Title</label>
                                <input type="text" class="form-control" id="title" name="title">
                            </div>
                            <div class="mb-3">
                                <label for="description" class="form-label">Description</label>
                                <textarea class="form-control" id="description" name="description"></textarea>
                            </div>
                            <div class="mb-3">
                                <label for="assignedTo" class="form-label">Assigned To</label>
                                <select class="form-control" id="assignedTo" name="assignedTo">
                                    <option label=" "></option>
                                    <% for(let i = 0; i < users.length; i++){ %>
                                        <option value="<%= users[i]._id %>"><%= users[i].name %></option>
                                    <% } %>
                                </select>
                            </div>
                            <div class="mb-3">
                                <label for="priority" class="form-label">Priority</label>
                                <select class="form-control" id="priority" name="priority">
                                    <option value="low">Low</option>
                                    <option value="medium" selected>Medium</option>
                                    <option value="high">High</option>
                                    <option value="critical">Critical</option>
                                </select>
                            </div>
                            <div class="mb-3">
                                <label for="dueDate" class="form-label">Due Date</label>
                                <input type="date" class="form-control" id="dueDate" name="dueDate">
                            </div>
                            <button type="submit" class="btn bg-info" style="color:white" value="Upload">Submit</button>
                        </form>
                    </div>
                </div>      
            </section>
        </div>

        <div class="box task-list-container">
            <section class="task-list">
                <div class="row justify-content-center">
                    <div class="col-6 mt-5">
                        <h2><%= user.name %>'s Task List</h2>
                        <!-- bootstrap accordion -->
                        <div class="accordion" id="accordionPanelsStayOpenExample">
                            <% for(let i = 0; i < tasks.length; i++) { %>
                                <div class="accordion-item">
                                    <h2 class="accordion-header">
                                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse<%= i %>" aria-expanded="false" aria-controls="collapse<%= i %>">
                                            <strong><%= tasks[i].title %></strong>
                                      </button>
                                    </h2>
                                    <div id="collapse<%= i %>" class="accordion-collapse collapse">
                                      <div class="accordion-body">
                                        <p><%= tasks[i].description %></p>
                                        <table class="table table-striped">
                                            <thead>
                                                <tr>
                                                    <th>Created By</th>
                                                    <th>Priority</th>
                                                    <th>Due Date</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td class="table-primary"><%= tasks[i].createdBy.name %></td>
                                                    <td class="table-primary"><%= tasks[i].priority %></td>
                                                    <td class="table-primary"><%= tasks[i].dueDate.toLocaleDateString('en-US') %></td>
                                                </tr>
                                            </tbody> 
                                        </table>
                                      </div>
                                    </div>
                                </div>
                            <% } %>
                        </div>
                    </div>
                </div>
            </section>
        </div>

    </div>


    


    
    
</main>
<%- include('partials/footer') -%>